<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="crew-schedule.css">
    <script src="crew-schedule.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Roboto:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB8GZFzfpxUMK_aqGNAmCZexZXMYB17BIc"></script>
    <script src="https://kit.fontawesome.com/7c8801c017.js" crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CONDOR Home3</title>
</head>

<body onload="loadMap()">

    <div class="topnav">
        <p><a href="./home3.html"><i class="fa-solid fa-user"></i> Account</a></p>
        <p><a href="./live-map.html"><i class="fa-solid fa-map"></i> Live Map</a></p>
        <p><a href="./crew-schedule.html"><i class="fa-solid fa-calendar-days"></i> Crew Schedule</a></p>

    </div>

    <div class="body-container">
        <div class="schedule-container">
            <p><i class="fa-solid fa-calendar-days"></i> Crew Schedule</p>
            <h1>Flight Delay Probability Search</h1>
  <input type="text" id="flightNumberInput" placeholder="Enter flight number">
  <button id="searchButton">Search</button>
  <div id="searchResult"></div>

  <script>
    // Function to parse the CSV data and search for flight delay probability
    function searchFlightDelayProbability(csvData, flightNumber) {
      const rows = csvData.split("\n");

      for (let i = 1; i < rows.length; i++) { // Start from index 1 to skip header row
        const cells = rows[i].split(",");
        const currentFlightNumber = cells[2].trim();
        const delayProbability = cells[10].trim();

        if (currentFlightNumber === flightNumber) {
          return delayProbability;
        }
      }

      return "Flight not found";
    }

    // Function to handle search button click event
    function handleSearch() {
      const flightNumberInput = document.getElementById("flightNumberInput");
      const searchResult = document.getElementById("searchResult");

      const flightNumber = flightNumberInput.value.trim();

      // Fetch the CSV file from S3
      fetch("s3://condor-prediction/predicted_data_20230608192025.csv")
        .then(response => response.text())
        .then(data => {
          const delayProbability = searchFlightDelayProbability(data, flightNumber);
          searchResult.textContent = `Flight ${flightNumber}: ${delayProbability}`;
        })
        .catch(error => {
          console.error("Error fetching CSV data:", error);
        });
    }

    const searchButton = document.getElementById("searchButton");
    searchButton.addEventListener("click", handleSearch);
  </script>
        </div>
    </div>

</body>
</html>